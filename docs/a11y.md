# Accessibility Rules

Lyra enforces accessibility at compile time. Rules run during the a11y pass and produce diagnostics based on the configured `a11yLevel` (`"strict"` | `"warn"` | `"off"`).

## Rules Summary

| Code          | Rule                                                   | Severity   |
| ------------- | ------------------------------------------------------ | ---------- |
| LYRA_A11Y_001 | Interactive controls must have an accessible name      | error/warn |
| LYRA_A11Y_002 | `<img>` must have an `alt` attribute                   | error/warn |
| LYRA_A11Y_003 | `<button>` must have visible text or accessible label  | error/warn |
| LYRA_A11Y_004 | Form controls with `id` must have a matching `<label>` | error/warn |
| LYRA_A11Y_005 | `<a>` must have an `href` attribute                    | error/warn |
| LYRA_A11Y_006 | `tabindex` must not be greater than 0                  | error/warn |
| LYRA_A11Y_007 | Headings (`<h1>`-`<h6>`) must not be empty             | error/warn |
| LYRA_A11Y_008 | `<iframe>` must have a `title` attribute               | error/warn |

## LYRA_A11Y_001: Accessible Name Required

Interactive controls (`<input>`, `<select>`, `<textarea>`, `<button>`) must have an accessible name via `aria-label`, `aria-labelledby`, `title`, or `id`.

```tsx
// Fails
<input />
<button></button>

// Passes
<input aria-label="Search" />
<input id="email" />
<button title="Submit">Go</button>
```

**WCAG**: [4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG21/Understanding/name-role-value.html)

## LYRA_A11Y_002: Image Alt Text

`<img>` elements must have an `alt` attribute (or `aria-label` / `aria-labelledby`).

```tsx
// Fails
<img src="/logo.png" />

// Passes
<img src="/logo.png" alt="Company logo" />
<img src="/decorative.png" alt="" />
<img src="/icon.svg" aria-label="Settings" />
```

**WCAG**: [1.1.1 Non-text Content](https://www.w3.org/WAI/WCAG21/Understanding/non-text-content.html)

## LYRA_A11Y_003: Button Text

`<button>` elements must have visible text content, or an accessible label via `aria-label` / `aria-labelledby`.

```tsx
// Fails
<button></button>
<button>   </button>
<button />

// Passes
<button>Click me</button>
<button aria-label="Close"><Icon /></button>
<button>{label}</button>
```

**WCAG**: [4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG21/Understanding/name-role-value.html)

## LYRA_A11Y_004: Form Label Association

Form controls (`<input>`, `<select>`, `<textarea>`) with an `id` attribute must have a matching `<label htmlFor="...">` in the same file. This rule does not fire if `aria-label` or `aria-labelledby` is present.

```tsx
// Fails
<input id="email" />

// Passes
<label htmlFor="email">Email</label>
<input id="email" />

// Also passes (ARIA labelling)
<input id="email" aria-label="Email address" />
```

**WCAG**: [1.3.1 Info and Relationships](https://www.w3.org/WAI/WCAG21/Understanding/info-and-relationships.html)

## LYRA_A11Y_005: Anchor Href

`<a>` elements must have an `href` attribute. Anchors without `href` are not keyboard-accessible.

```tsx
// Fails
<a>Link</a>
<a />

// Passes
<a href="/page">Link</a>
<a href="#">Link</a>
```

**WCAG**: [2.1.1 Keyboard](https://www.w3.org/WAI/WCAG21/Understanding/keyboard.html)

## LYRA_A11Y_006: Positive Tabindex

`tabindex` must not be greater than 0. Positive `tabindex` values disrupt the natural tab order and create a confusing experience for keyboard users.

```tsx
// Fails
<div tabIndex="5" />
<div tabindex="3" />

// Passes
<div tabIndex="0" />
<div tabIndex="-1" />
```

**WCAG**: [2.4.3 Focus Order](https://www.w3.org/WAI/WCAG21/Understanding/focus-order.html)

## LYRA_A11Y_007: Empty Headings

Headings (`<h1>` through `<h6>`) must have text content for screen readers. Empty headings create confusing document structure.

```tsx
// Fails
<h1></h1>
<h2>   </h2>

// Passes
<h1>Page Title</h1>
<h3>{dynamicTitle}</h3>
<h1 aria-label="title"></h1>
```

**WCAG**: [1.3.1 Info and Relationships](https://www.w3.org/WAI/WCAG21/Understanding/info-and-relationships.html)

## LYRA_A11Y_008: Iframe Title

`<iframe>` elements must have a `title` attribute (or `aria-label` / `aria-labelledby`) to describe their content to screen readers.

```tsx
// Fails
<iframe src="/embed" />

// Passes
<iframe src="/embed" title="Map widget" />
<iframe src="/embed" aria-label="Map widget" />
```

**WCAG**: [4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG21/Understanding/name-role-value.html)

## Configuration

Set `a11yLevel` in compile options:

- `"strict"` (default) — a11y violations are **errors** (fail compilation)
- `"warn"` — a11y violations are **warnings**
- `"off"` — skip a11y checks entirely

## Planned Rules

- Landmarks: single `<main>`, proper header/footer usage
- Heading level continuity (h1 → h2 → h3, no skipping)
- Role/ARIA validity for element
- `<html>` `lang` attribute
- Color contrast estimation (static analysis)
